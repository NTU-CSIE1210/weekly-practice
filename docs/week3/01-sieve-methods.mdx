---
sidebar_position: 2
title: 'Sieve Methods'
exercises: []
---


# {frontMatter.title}

Here we discuss two different ideas to generate all prime numbers that is at most $n$.

## Basic Ingredient: Sieve of Eratosthenes

* https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes

### Time complexity?

* We know that harmonic series adds up to $O(\log n)$.
* How about adding reciprocals of prime numbers?

$$\displaystyle\sum_{p\le n: \text{ prime}} \frac1p = \frac12 + \frac13 + \frac15+\frac17 + \cdots$$

* This actually reaches $O(\log\log n)$, a much smaller growth function compared to $O(\log n)$!

### Potential Speed Up 

There are some ideas to shortcutting the computation.
Although it does not affect the actual time complexity, it does save a significant amount of time in practice.

1. When sieving $i$, instead of checking $2i, 3i, 4i, \ldots$ you check $i^2, i^2+i, i^2+2i, \ldots$.
(This implies that it suffices to sieve up to $\sqrt{n}$.)
2. When dealing with any number greater than 6, you only consider values that modulo 6 equals to 1 or 5.
(This makes your code complicate (why?) but it works effectively.)


## Linear Sieve

This is a more advanced (but however, useless) idea.
The Sieve of Eratosthenes does not require lots of multiplications.
If we can use lots of multiplications and additional space, there is actually an interesting idea achieving $O(n)$ time sieving.

* https://cp-algorithms.com/algebra/prime-sieve-linear.html
